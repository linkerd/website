name: linkerd profile
synopsis: Output service profile config for Kubernetes
description: |-
  Output service profile config for Kubernetes.

  This outputs a service profile for the given service.

  Examples:
    If the --template flag is specified, it outputs a service profile template.
    Edit the template and then apply it with kubectl to add a service profile to
    a service:

    linkerd profile -n emojivoto --template web-svc > web-svc-profile.yaml
    # (edit web-svc-profile.yaml manually)
    kubectl apply -f web-svc-profile.yaml

    If the --open-api flag is specified, it reads the given OpenAPI
    specification file and outputs a corresponding service profile:

    linkerd profile -n emojivoto --open-api web-svc.swagger web-svc | kubectl apply -f -

    If the --proto flag is specified, it reads the given protobuf definition file
    and outputs a corresponding service profile:

    linkerd profile -n emojivoto --proto Voting.proto vote-svc | kubectl apply -f -

    If the --tap flag is specified, it runs linkerd tap target for --tap-duration seconds,
    and creates a profile for the SERVICE based on the requests seen in that window:

    linkerd profile books --tap deploy/books --tap-duration 10s --tap-route-limit 5 > book-svc-profile.yaml
    # (edit book-svc-profile.yaml manually)
    kubectl apply -f book-svc-profile.yaml

    The command will run linkerd tap deploy/books for tap-duration seconds, and then create
    a service profile for the books service with routes prepopulated from the tap data.
    For high RPS, high-route-cardinality services, use tap-route-limit to limit the number of
    routes in the output profile.
options:
- name: help
  shorthand: h
  default_value: "false"
  usage: help for profile
- name: namespace
  shorthand: "n"
  default_value: default
  usage: Namespace of the service
- name: open-api
  usage: |
    Output a service profile based on the given OpenAPI spec file
- name: proto
  usage: |
    Output a service profile based on the given Protobuf spec file
- name: tap
  usage: |
    Output a service profile based on tap data for the given target resource
- name: tap-duration
  default_value: 5s
  usage: |
    Duration over which tap data is collected (for example: "10s", "1m", "10m")
- name: tap-route-limit
  default_value: "20"
  usage: Max number of routes to add to the profile
- name: template
  default_value: "false"
  usage: Output a service profile template
inherited_options:
- name: api-addr
  usage: |
    Override kubeconfig and communicate directly with the control plane at host:port (mostly for testing)
- name: context
  usage: Name of the kubeconfig context to use
- name: kubeconfig
  usage: Path to the kubeconfig file to use for CLI requests
- name: linkerd-namespace
  shorthand: l
  default_value: linkerd
  usage: Namespace in which Linkerd is installed [$LINKERD_NAMESPACE]
- name: verbose
  default_value: "false"
  usage: Turn on debug logging
see_also:
- linkerd - linkerd manages the Linkerd service mesh
